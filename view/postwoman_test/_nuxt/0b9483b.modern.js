(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{595:function(e,t,n){"use strict";n.d(t,"c",(function(){return N})),n.d(t,"a",(function(){return x})),n.d(t,"u",(function(){return U})),n.d(t,"p",(function(){return J})),n.d(t,"n",(function(){return A})),n.d(t,"f",(function(){return P})),n.d(t,"g",(function(){return z})),n.d(t,"r",(function(){return F})),n.d(t,"i",(function(){return V})),n.d(t,"j",(function(){return G})),n.d(t,"o",(function(){return H})),n.d(t,"t",(function(){return Q})),n.d(t,"d",(function(){return Y})),n.d(t,"e",(function(){return te})),n.d(t,"b",(function(){return ae})),n.d(t,"s",(function(){return re})),n.d(t,"m",(function(){return se})),n.d(t,"l",(function(){return ue})),n.d(t,"k",(function(){return me})),n.d(t,"q",(function(){return be})),n.d(t,"h",(function(){return ve}));var r,o,l,c,m,d,v,h,$,f,I,D,y,O,j,_,S,C,M,T,w,R=n(205),E=n(3),k=(n(18),n(20),n(69),n(83));n(304);function N(e,t){return e.mutate({mutation:Object(k.a)(r||(r=Object(R.a)(["\n      mutation ($name: String!) {\n        createTeam(name: $name) {\n          name\n        }\n      }\n    "]))),variables:{name:t}})}function x(e,t,n,r){return e.mutate({mutation:Object(k.a)(o||(o=Object(R.a)(["\n      mutation addTeamMemberByEmail(\n        $userRole: TeamMemberRole!\n        $userEmail: String!\n        $teamID: String!\n      ) {\n        addTeamMemberByEmail(\n          userRole: $userRole\n          userEmail: $userEmail\n          teamID: $teamID\n        ) {\n          role\n        }\n      }\n    "]))),variables:{userRole:t,userEmail:n,teamID:r}})}function U(e,t,n,r){return e.mutate({mutation:Object(k.a)(l||(l=Object(R.a)(["\n      mutation updateTeamMemberRole(\n        $newRole: TeamMemberRole!\n        $userUid: String!\n        $teamID: String!\n      ) {\n        updateTeamMemberRole(\n          newRole: $newRole\n          userUid: $userUid\n          teamID: $teamID\n        ) {\n          role\n        }\n      }\n    "]))),variables:{newRole:n,userUid:t,teamID:r}})}function J(e,t,n){return e.mutate({mutation:Object(k.a)(c||(c=Object(R.a)(["\n      mutation renameTeam($newName: String!, $teamID: String!) {\n        renameTeam(newName: $newName, teamID: $teamID) {\n          id\n        }\n      }\n    "]))),variables:{newName:t,teamID:n}})}function A(e,t,n){return e.mutate({mutation:Object(k.a)(m||(m=Object(R.a)(["\n      mutation removeTeamMember($userUid: String!, $teamID: String!) {\n        removeTeamMember(userUid: $userUid, teamID: $teamID)\n      }\n    "]))),variables:{userUid:t,teamID:n}})}function P(e,t){return W.apply(this,arguments)}function W(){return(W=Object(E.a)((function*(e,t){for(var n;void 0===(n=yield e.mutate({mutation:Object(k.a)(v||(v=Object(R.a)(["\n        mutation ($teamID: String!) {\n          deleteTeam(teamID: $teamID)\n        }\n      "]))),variables:{teamID:t}})););return n}))).apply(this,arguments)}function z(e,t){e.mutate({mutation:Object(k.a)(d||(d=Object(R.a)(["\n      mutation ($teamID: String!) {\n        leaveTeam(teamID: $teamID)\n      }\n    "]))),variables:{teamID:t}})}function F(e,t){return B.apply(this,arguments)}function B(){return(B=Object(E.a)((function*(e,t){for(var n=[],cursor="";;){var r=yield e.query({query:Object(k.a)(h||(h=Object(R.a)(["\n        query rootCollectionsOfTeam($teamID: String!, $cursor: String!) {\n          rootCollectionsOfTeam(teamID: $teamID, cursor: $cursor) {\n            id\n            title\n          }\n        }\n      "]))),variables:{teamID:t,cursor:cursor},fetchPolicy:"no-cache"});if(0===r.data.rootCollectionsOfTeam.length)break;r.data.rootCollectionsOfTeam.forEach((e=>{n.push(e)})),cursor=n[n.length-1].id}return n}))).apply(this,arguments)}function V(e,t){return Z.apply(this,arguments)}function Z(){return(Z=Object(E.a)((function*(e,t){var n=[];return(yield e.query({query:Object(k.a)($||($=Object(R.a)(["\n      query getCollectionChildren($collectionID: String!) {\n        collection(collectionID: $collectionID) {\n          children {\n            id\n            title\n          }\n        }\n      }\n    "]))),variables:{collectionID:t},fetchPolicy:"no-cache"})).data.collection.children.forEach((e=>{n.push(e)})),n}))).apply(this,arguments)}function G(e,t){return L.apply(this,arguments)}function L(){return(L=Object(E.a)((function*(e,t){for(var n=[],cursor="";;){var r=yield e.query({query:Object(k.a)(f||(f=Object(R.a)(["\n        query getCollectionRequests($collectionID: String!, $cursor: String) {\n          requestsInCollection(collectionID: $collectionID, cursor: $cursor) {\n            id\n            title\n            request\n          }\n        }\n      "]))),variables:{collectionID:t,cursor:cursor},fetchPolicy:"no-cache"});if(r.data.requestsInCollection.forEach((e=>{n.push(e)})),r.data.requestsInCollection.length<10)break;cursor=n[n.length-1].id}return n}))).apply(this,arguments)}function H(e,t,n){return K.apply(this,arguments)}function K(){return(K=Object(E.a)((function*(e,title,t){for(var n;void 0===(n=yield e.mutate({mutation:Object(k.a)(I||(I=Object(R.a)(["\n        mutation ($newTitle: String!, $collectionID: String!) {\n          renameCollection(newTitle: $newTitle, collectionID: $collectionID) {\n            id\n          }\n        }\n      "]))),variables:{newTitle:title,collectionID:t}})););return n}))).apply(this,arguments)}function Q(e,t,n,r){return X.apply(this,arguments)}function X(){return(X=Object(E.a)((function*(e,t,n,r){for(var o;void 0===(o=yield e.mutate({mutation:Object(k.a)(D||(D=Object(R.a)(["\n        mutation ($data: UpdateTeamRequestInput!, $requestID: String!) {\n          updateRequest(data: $data, requestID: $requestID) {\n            id\n          }\n        }\n      "]))),variables:{data:{request:JSON.stringify(t),title:n},requestID:r}})););return o}))).apply(this,arguments)}function Y(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(E.a)((function*(e,t){for(var n;void 0===(n=yield e.mutate({mutation:Object(k.a)(y||(y=Object(R.a)(["\n        mutation ($collectionID: String!) {\n          deleteCollection(collectionID: $collectionID)\n        }\n      "]))),variables:{collectionID:t}})););return n}))).apply(this,arguments)}function te(e,t){return ne.apply(this,arguments)}function ne(){return(ne=Object(E.a)((function*(e,t){for(var n;void 0===(n=yield e.mutate({mutation:Object(k.a)(O||(O=Object(R.a)(["\n        mutation ($requestID: String!) {\n          deleteRequest(requestID: $requestID)\n        }\n      "]))),variables:{requestID:t}})););return n}))).apply(this,arguments)}function ae(e,t,n){return ie.apply(this,arguments)}function ie(){return(ie=Object(E.a)((function*(e,title,t){for(var n;void 0===(n=yield e.mutate({mutation:Object(k.a)(j||(j=Object(R.a)(["\n        mutation ($title: String!, $teamID: String!) {\n          createRootCollection(title: $title, teamID: $teamID) {\n            id\n          }\n        }\n      "]))),variables:{title:title,teamID:t}})););return n}))).apply(this,arguments)}function re(e,t,n,r,o){return oe.apply(this,arguments)}function oe(){return(oe=Object(E.a)((function*(e,t,title,n,r){yield e.mutate({mutation:Object(k.a)(_||(_=Object(R.a)(["\n      mutation ($data: CreateTeamRequestInput!, $collectionID: String!) {\n        createRequestInCollection(data: $data, collectionID: $collectionID) {\n          collection {\n            id\n            team {\n              id\n              name\n            }\n          }\n        }\n      }\n    "]))),variables:{collectionID:r,data:{teamID:n,title:title,request:t}}})}))).apply(this,arguments)}function se(e,t,n,r){return le.apply(this,arguments)}function le(){return(le=Object(E.a)((function*(e,t,title,n){yield e.mutate({mutation:Object(k.a)(S||(S=Object(R.a)(["\n      mutation updateRequest(\n        $data: UpdateTeamRequestInput!\n        $requestID: String!\n      ) {\n        updateRequest(data: $data, requestID: $requestID) {\n          id\n          title\n        }\n      }\n    "]))),variables:{requestID:n,data:{request:t,title:title}}})}))).apply(this,arguments)}function ue(e,t,n){return ce.apply(this,arguments)}function ce(){return(ce=Object(E.a)((function*(e,t,n){return null!=(yield e.mutate({mutation:Object(k.a)(C||(C=Object(R.a)(["\n      mutation importFromMyCollections(\n        $fbCollectionPath: String!\n        $teamID: String!\n      ) {\n        importCollectionFromUserFirestore(\n          fbCollectionPath: $fbCollectionPath\n          teamID: $teamID\n        ) {\n          id\n          title\n        }\n      }\n    "]))),variables:{fbCollectionPath:t,teamID:n}})).data}))).apply(this,arguments)}function me(e,t,n){return de.apply(this,arguments)}function de(){return(de=Object(E.a)((function*(e,t,n){return null!=(yield e.mutate({mutation:Object(k.a)(M||(M=Object(R.a)(["\n      mutation importFromJSON($jsonString: String!, $teamID: String!) {\n        importCollectionsFromJSON(jsonString: $jsonString, teamID: $teamID)\n      }\n    "]))),variables:{jsonString:JSON.stringify(t),teamID:n}})).data}))).apply(this,arguments)}function be(e,t,n){return pe.apply(this,arguments)}function pe(){return(pe=Object(E.a)((function*(e,t,n){return null!=(yield e.mutate({mutation:Object(k.a)(T||(T=Object(R.a)(["\n      mutation replaceWithJSON($jsonString: String!, $teamID: String!) {\n        replaceCollectionsWithJSON(jsonString: $jsonString, teamID: $teamID)\n      }\n    "]))),variables:{jsonString:JSON.stringify(t),teamID:n}})).data}))).apply(this,arguments)}function ve(e,t){return he.apply(this,arguments)}function he(){return(he=Object(E.a)((function*(e,t){return(yield e.query({query:Object(k.a)(w||(w=Object(R.a)(["\n      query exportAsJSON($teamID: String!) {\n        exportCollectionsToJSON(teamID: $teamID)\n      }\n    "]))),variables:{teamID:t}})).data.exportCollectionsToJSON}))).apply(this,arguments)}},627:function(e,t,n){var r=n(312);e.exports=function(e){return r(e,5)}},830:function(e,t,n){"use strict";n.r(t);n(68);var r,o,l,c,m=n(627),d=n.n(m),v=n(595),h=n(205),$=n(3),f=(n(18),n(20),n(69),n(304)),I=n(83),D=n(85);class y{constructor(e){this.teamID=e,this.members$=new f.a([]),this.teamMemberAdded$=null,this.teamMemberUpdated$=null,this.teamMemberRemoved$=null,this.teamID&&this.initialize()}changeTeamID(e){this.members$.next([]),this.teamID=e,this.teamID&&this.initialize()}unsubscribeSubscriptions(){var e,t,n;null===(e=this.teamMemberAdded$)||void 0===e||e.unsubscribe(),null===(t=this.teamMemberRemoved$)||void 0===t||t.unsubscribe(),null===(n=this.teamMemberUpdated$)||void 0===n||n.unsubscribe()}initialize(){var e=this;return Object($.a)((function*(){yield e.loadTeamMembers(),e.registerSubscriptions()}))()}loadTeamMembers(){var e=this;return Object($.a)((function*(){for(var t=[],cursor=null;;){var n=yield D.a.query({query:Object(I.a)(r||(r=Object(h.a)(["\n          query GetTeamMembers($teamID: String!, $cursor: String) {\n            team(teamID: $teamID) {\n              members(cursor: $cursor) {\n                membershipID\n                user {\n                  uid\n                  email\n                }\n                role\n              }\n            }\n          }\n        "]))),variables:{teamID:e.teamID,cursor:cursor}});if(t.push(...n.data.team.members),0===n.data.team.members.length)break;cursor=n.data.team.members[n.data.team.members.length-1].membershipID}e.members$.next(t)}))()}registerSubscriptions(){this.teamMemberAdded$=D.a.subscribe({query:Object(I.a)(o||(o=Object(h.a)(["\n          subscription TeamMemberAdded($teamID: String!) {\n            teamMemberAdded(teamID: $teamID) {\n              user {\n                uid\n                email\n              }\n              role\n            }\n          }\n        "]))),variables:{teamID:this.teamID}}).subscribe((e=>{var{data:data}=e;this.members$.next([...this.members$.value,data.teamMemberAdded])})),this.teamMemberRemoved$=D.a.subscribe({query:Object(I.a)(l||(l=Object(h.a)(["\n          subscription TeamMemberRemoved($teamID: String!) {\n            teamMemberRemoved(teamID: $teamID)\n          }\n        "]))),variables:{teamID:this.teamID}}).subscribe((e=>{var{data:data}=e;this.members$.next(this.members$.value.filter((e=>e.user.uid!==data.teamMemberRemoved)))})),this.teamMemberUpdated$=D.a.subscribe({query:Object(I.a)(c||(c=Object(h.a)(["\n          subscription TeamMemberUpdated($teamID: String!) {\n            teamMemberUpdated(teamID: $teamID) {\n              user {\n                uid\n                email\n              }\n              role\n            }\n          }\n        "]))),variables:{teamID:this.teamID}}).subscribe((e=>{var{data:data}=e,t=d()(this.members$.value).find((e=>e.user.uid===data.teamMemberUpdated.user.uid));t&&Object.assign(t,data.teamMemberUpdated)}))}}var O={props:{show:Boolean,editingTeam:{type:Object,default:()=>{}},editingteamID:{type:String,default:null}},data:()=>({rename:null,doneButton:'<i class="material-icons">done</i>',members:[],newMembers:[],membersAdapter:new y(null)}),computed:{editingTeamCopy(){return this.editingTeam},name:{get(){return this.editingTeam.name},set(e){this.rename=e}}},watch:{editingteamID(e){this.membersAdapter.changeTeamID(e)}},mounted(){this.membersAdapter.members$.subscribe((e=>{this.members=d()(e)}))},methods:{updateRole(e,t){this.members[e].role=t},addTeamMember(){this.newMembers.push({key:"",value:""})},removeExistingTeamMember(e){v.n(this.$apollo,e,this.editingteamID).then((()=>{this.$toast.success(this.$t("user_removed"),{icon:"done"}),this.hideModal()})).catch((e=>{this.$toast.error(this.$t("error_occurred"),{icon:"done"}),console.error(e)}))},removeTeamMember(e){this.newMembers.splice(e,1)},validateEmail:e=>!!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(e),saveTeam(){if(null!==this.$data.rename&&this.$data.rename.replace(/\s/g,"").length<6)this.$toast.error(this.$t("string_length_insufficient"),{icon:"error"});else{this.$data.newMembers.forEach((element=>{this.validateEmail(element.key)||this.$toast.error(this.$t("invalid_emailID_format"),{icon:"error"})})),this.$data.newMembers.forEach((element=>{v.a(this.$apollo,element.value,element.key,this.editingteamID).then((()=>{this.$toast.success(this.$t("team_saved"),{icon:"done"}),this.hideModal()})).catch((e=>{this.$toast.error(this.$t("error_occurred"),{icon:"done"}),console.error(e)}))}));var e=!0;if(this.members.forEach((element=>{v.u(this.$apollo,element.user.uid,element.role,this.editingteamID).then((()=>{e&&(this.$toast.success(this.$t("role_updated"),{icon:"done"}),e=!1),this.hideModal()})).catch((t=>{e&&(this.$toast.error(this.$t("error_occurred"),{icon:"done"}),e=!1),console.error(t)}))})),null!==this.$data.rename){var t=this.name===this.$data.rename?this.name:this.$data.rename;if(!/\S/.test(t))return this.$toast.error(this.$t("team_name_empty"),{icon:"error"});this.name!==this.rename&&v.p(this.$apollo,t,this.editingteamID).then((()=>{this.$toast.success(this.$t("team_saved"),{icon:"done"}),this.hideModal()})).catch((e=>{this.$toast.error(this.$t("error_occurred"),{icon:"done"}),console.error(e)}))}this.hideModal(),this.newMembers=[]}},hideModal(){this.rename=null,this.$emit("hide-modal")}}},j=n(12),component=Object(j.a)(O,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.show?n("SmartModal",{on:{close:e.hideModal}},[n("div",{attrs:{slot:"header"},slot:"header"},[n("ul",[n("li",[n("div",{staticClass:"row-wrapper"},[n("h3",{staticClass:"title"},[e._v(e._s(e.$t("edit_team")))]),e._v(" "),n("div",[n("button",{staticClass:"icon",on:{click:e.hideModal}},[n("i",{staticClass:"material-icons"},[e._v("close")])])])])])])]),e._v(" "),n("div",{attrs:{slot:"body"},slot:"body"},[n("ul",[n("li",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],attrs:{type:"text",placeholder:e.editingTeam.name},domProps:{value:e.name},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.saveTeam(t)},input:function(t){t.target.composing||(e.name=t.target.value)}}})])]),e._v(" "),n("ul",[n("li",[n("div",{staticClass:"row-wrapper"},[n("label",{attrs:{for:"memberList"}},[e._v(e._s(e.$t("team_member_list")))]),e._v(" "),n("div")])])]),e._v(" "),e._l(e.members,(function(t,r){return n("ul",{key:"new-"+r,staticClass:"\n        border-b border-dashed\n        divide-y\n        md:divide-x\n        border-brdColor\n        divide-dashed divide-brdColor\n        md:divide-y-0\n      ",class:{"border-t":0==r}},[n("li",[n("input",{attrs:{placeholder:e.$t("email"),name:"param"+r,readonly:""},domProps:{value:t.user.email}})]),e._v(" "),n("li",[n("span",{staticClass:"select-wrapper"},[n("v-popover",[n("input",{attrs:{placeholder:e.$t("permissions"),name:"value"+r,readonly:""},domProps:{value:"string"==typeof t.role?t.role:JSON.stringify(t.role)}}),e._v(" "),n("template",{slot:"popover"},[n("div",[n("button",{directives:[{name:"close-popover",rawName:"v-close-popover"}],staticClass:"icon",on:{click:function(t){return e.updateRole(r,"OWNER")}}},[e._v("\n                  OWNER\n                ")])]),e._v(" "),n("div",[n("button",{directives:[{name:"close-popover",rawName:"v-close-popover"}],staticClass:"icon",on:{click:function(t){return e.updateRole(r,"EDITOR")}}},[e._v("\n                  EDITOR\n                ")])]),e._v(" "),n("div",[n("button",{directives:[{name:"close-popover",rawName:"v-close-popover"}],staticClass:"icon",on:{click:function(t){return e.updateRole(r,"VIEWER")}}},[e._v("\n                  VIEWER\n                ")])])])],2)],1)]),e._v(" "),n("div",[n("li",[n("button",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.$t("delete"),expression:"$t('delete')",modifiers:{bottom:!0}}],staticClass:"icon",attrs:{id:"member"},on:{click:function(n){return e.removeExistingTeamMember(t.user.uid)}}},[n("i",{staticClass:"material-icons"},[e._v("delete")])])])])])})),e._v(" "),e._l(e.newMembers,(function(t,r){return n("ul",{key:r,staticClass:"\n        border-b border-dashed\n        divide-y\n        md:divide-x\n        border-brdColor\n        divide-dashed divide-brdColor\n        md:divide-y-0\n      "},[n("li",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.key,expression:"member.key"}],attrs:{placeholder:e.$t("email"),name:"param"+r,autofocus:""},domProps:{value:t.key},on:{input:function(n){n.target.composing||e.$set(t,"key",n.target.value)}}})]),e._v(" "),n("li",[n("span",{staticClass:"select-wrapper"},[n("v-popover",[n("input",{attrs:{placeholder:e.$t("permissions"),name:"value"+r,readonly:""},domProps:{value:"string"==typeof t.value?t.value:JSON.stringify(t.value)}}),e._v(" "),n("template",{slot:"popover"},[n("div",[n("button",{directives:[{name:"close-popover",rawName:"v-close-popover"}],staticClass:"icon",on:{click:function(e){t.value="OWNER"}}},[e._v("\n                  OWNER\n                ")])]),e._v(" "),n("div",[n("button",{directives:[{name:"close-popover",rawName:"v-close-popover"}],staticClass:"icon",on:{click:function(e){t.value="EDITOR"}}},[e._v("\n                  EDITOR\n                ")])]),e._v(" "),n("div",[n("button",{directives:[{name:"close-popover",rawName:"v-close-popover"}],staticClass:"icon",on:{click:function(e){t.value="VIEWER"}}},[e._v("\n                  VIEWER\n                ")])])])],2)],1)]),e._v(" "),n("div",[n("li",[n("button",{directives:[{name:"tooltip",rawName:"v-tooltip.bottom",value:e.$t("delete"),expression:"$t('delete')",modifiers:{bottom:!0}}],staticClass:"icon",attrs:{id:"member"},on:{click:function(t){return e.removeTeamMember(r)}}},[n("i",{staticClass:"material-icons"},[e._v("delete")])])])])])})),e._v(" "),n("ul",[n("li",[n("button",{staticClass:"icon",on:{click:e.addTeamMember}},[n("i",{staticClass:"material-icons"},[e._v("add")]),e._v(" "),n("span",[e._v(e._s(e.$t("add_new")))])])])])],2),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("div",{staticClass:"row-wrapper"},[n("span"),e._v(" "),n("span",[n("button",{staticClass:"icon",on:{click:e.hideModal}},[e._v("\n          "+e._s(e.$t("cancel"))+"\n        ")]),e._v(" "),n("button",{staticClass:"icon primary",on:{click:e.saveTeam}},[e._v("\n          "+e._s(e.$t("save"))+"\n        ")])])])])]):e._e()}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{SmartModal:n(150).default})}}]);